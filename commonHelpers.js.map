{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".load-more\");\n\nlet page = 1;\nlet isLastPage = false;\nconst perPage = 40;\nlet q;\nlet totalHits;\n\nform.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n    page = 1;\n    showLoader();\n    gallery.innerHTML = \"\";\n\n    q = event.currentTarget.elements.search.value.trim();\n   \n    if (q.length === 0) {\n        showErrorToast(errorMessage);\n        hideLoader();\n    } else {\n        try {\n            btnLoadMore.style.display = 'none';\n            const images = await getIMG(q);\n            renderIMG(images);\n        } catch (error) {\n            console.error(error);\n            showErrorToast(errorMessage);\n        } finally {\n            hideLoader();\n        }\n    }\n});\n\nasync function getIMG(query = \"\") {\n    const instance = axios.create({\n        baseURL: 'https://pixabay.com/api/',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        params: {\n            key: \"41729431-93e496ed3cd794296b45db789\",\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: \"true\",\n            page: page,\n            per_page: perPage,\n        }\n    });\n\n    try {\n        const response = await instance.get();\n\n        const data = await response.data;\n        if (data.hits.length) {\n            totalHits = data.totalHits;\n            return data.hits;\n        } else {\n            showErrorToast(errorMessage);\n            hideLoader();\n            return;\n        }\n    } catch {\n        showErrorToast(errorMessage);\n        return;\n    }\n}\n\nconst createGetIMGRequest = async () => {\n        try {\n            if (isLastPage) {\n                showErrorToast(\"We're sorry, but you've reached the end of search results.\");\n                return;\n            }\n            \n            page++;\n\n            try {\n            showLoader();\n            btnLoadMore.style.display = 'none';\n            const images = await getIMG(q);\n            renderIMG(images);\n            window.scrollBy({\n                top: getScroll() * 2,\n                behavior: \"smooth\"\n            });\n            } catch (error) {\n            console.error(error);\n            showErrorToast(errorMessage);\n            } finally {\n            hideLoader();\n            }\n            if (page >= totalHits / perPage) {\n                isLastPage = true;\n                btnLoadMore.style.display = 'none';\n                showErrorToast(\"We're sorry, but you've reached the end of search results.\");\n            }\n        } catch {\n            showErrorToast(errorMessage);\n        }\n}\n\nbtnLoadMore.addEventListener('click', (event) => {\n    createGetIMGRequest();\n});\n\nconst getImageHTML = ({largeImageURL, webformatURL, tags, likes, views, comments, downloads}) => `           \n    <li class=\"gallery-item\">\n        <div class=gallery-card>\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\" />\n            </a>\n\n            <ul class=\"gallery-card-list\">\n                <li class=\"gallery-card-item\">\n                    <h2 class=\"gallery-card-title\">Likes</h2>\n                    <p class=\"gallery-card-information\">${likes}</p>\n                </li>\n                <li class=\"gallery-card-item\">\n                    <h2 class=\"gallery-card-title\">Views</h2>\n                    <p class=\"gallery-card-information\">${views}</p>\n                </li>\n                <li class=\"gallery-card-item\">\n                    <h2 class=\"gallery-card-title\">Comments</h2>\n                    <p class=\"gallery-card-information\">${comments}</p>\n                </li>\n                <li class=\"gallery-card-item\">\n                    <h2 class=\"gallery-card-title\">Downloads</h2>\n                    <p class=\"gallery-card-information\">${downloads}</p>\n                </li>\n            </ul>\n        </div>\n    </li>\n`\n\nconst lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n\nfunction renderIMG(images) {\n    if (images === undefined) {\n        return;\n    } else {\n        const markup = images.map((image => {\n            return getImageHTML(image);\n        })).join(\"\");\n        gallery.insertAdjacentHTML(\"beforeend\", markup);\n        lightbox.refresh();         \n        hideLoader();\n        if (Math.floor(totalHits / perPage) > 0) {\n            btnLoadMore.style.display = 'block';\n        }\n    }\n}\n\nfunction getScroll() {\n    const li = document.querySelector(\".gallery-item\");\n    const scrol = li.getBoundingClientRect().height;\n    return scrol;\n}\n\nfunction showErrorToast(message) {\n    iziToast.show({\n        title: message,\n        titleColor: 'white',\n        color: 'white',\n        backgroundColor: 'red',\n        position: 'topRight',\n    });\n}\n\nconst errorMessage = \"Sorry, there are no images matching your search query. Please try again!Reqest is not ok\";\n\nfunction showLoader() {\n    loader.classList.add('loading');\n}\n\nfunction hideLoader() {\n    loader.classList.remove('loading');\n}\n\n"],"names":["form","gallery","loader","btnLoadMore","page","isLastPage","perPage","q","totalHits","event","showLoader","showErrorToast","errorMessage","hideLoader","images","getIMG","renderIMG","error","query","instance","axios","data","createGetIMGRequest","getScroll","getImageHTML","largeImageURL","webformatURL","tags","likes","views","comments","downloads","lightbox","SimpleLightbox","markup","image","message","iziToast"],"mappings":"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"}